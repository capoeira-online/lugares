{"version":3,"sources":["app.js","environment.js","main.js","search-form.js","resources/index.js","resources/elements/loading-indicator.js","/Users/cbrown/Library/Mobile Documents/com~apple~CloudDocs/Projects/lugares/src/app.html","/Users/cbrown/Library/Mobile Documents/com~apple~CloudDocs/Projects/lugares/src/search-form.html","/Users/cbrown/Library/Mobile Documents/com~apple~CloudDocs/Projects/lugares/src/styles.css","/Users/cbrown/Library/Mobile Documents/com~apple~CloudDocs/Projects/lugares/src/search-form.css","/Users/cbrown/Library/Mobile Documents/com~apple~CloudDocs/Projects/lugares/src/app.css"],"names":["App","message","debug","testing","configure","Promise","config","longStackTraces","warnings","wForgottenReturn","aurelia","use","standardConfiguration","feature","developmentLogging","plugin","start","then","setRoot","SEARCH_AGAIN_CONFIRM","SEARCH_RESULTS_DOWNLOAD_CONFIRM","SEARCH_RESULTS_CITY_LIMIT","httpClient","useStandardConfiguration","withBaseUrl","withDefaults","credentials","headers","SearchForm","isRequesting","searchResults","searchResultsCityLimit","getPossibleDuplicates","i","placeId","dupes","possible_duplicates","hasOwnProperty","length","hasPossibleDuplicates","requestIndex","fetch","googleAPIKey","keyword","method","response","json","city_population","toLocaleString","people_per_result","Math","round","push","searchResultsCount","result","results","submit","doRequest","catch","alert","window","confirm","download","dataStr","dlAnchor","encodeURIComponent","JSON","stringify","document","getElementById","setAttribute","click","globalResources","nprogress","LoadingIndicator","name","defaultValue","on","loadingChanged","newValue","done"],"mappings":"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","file":"app-bundle.js","sourcesContent":["export class App {\n  constructor() {\n    this.message = 'Hello World!';\n  }\n}\n","export default {\n  debug: true,\n  testing: true\n};\n","import environment from './environment';\n\n//Configure Bluebird Promises.\nPromise.config({\n  longStackTraces: environment.debug,\n  warnings: {\n    wForgottenReturn: false\n  }\n});\n\nexport function configure(aurelia) {\n  aurelia.use\n    .standardConfiguration()\n    .feature('resources');\n\n  if (environment.debug) {\n    aurelia.use.developmentLogging();\n  }\n\n  if (environment.testing) {\n    aurelia.use.plugin('aurelia-testing');\n  }\n\n  aurelia.start().then(() => aurelia.setRoot());\n}\n","import {HttpClient} from 'aurelia-fetch-client';\n\nconst SEARCH_AGAIN_CONFIRM = 'Are you sure you want to start a new search? You will lose any data that you haven\\'t saved.';\nconst SEARCH_RESULTS_DOWNLOAD_CONFIRM = 'Are you sure you want to download places.json?';\nconst SEARCH_RESULTS_CITY_LIMIT = 1;\n\nlet httpClient = new HttpClient();\n\nhttpClient.configure(config => {\n  config\n    .useStandardConfiguration()\n    .withBaseUrl('http://localhost:8080/api/')\n    .withDefaults({\n      credentials: 'same-origin',\n      headers: {\n        'X-Requested-With': 'Fetch'\n      }\n    });\n});\n\nexport class SearchForm {\n  isRequesting = false;\n  searchResults = [];\n  searchResultsCount;\n  googleAPIKey;\n  keyword;\n\n  searchResultsCityLimit = SEARCH_RESULTS_CITY_LIMIT;\n  \n  getPossibleDuplicates(i, placeId) {\n    let dupes = [];\n\n    if (this.searchResults[i].possible_duplicates &&\n        this.searchResults[i].possible_duplicates.hasOwnProperty(placeId) &&\n        this.searchResults[i].possible_duplicates[placeId].length > 0)\n    {\n      dupes = this.searchResults[i].possible_duplicates[placeId];\n    }\n\n    return dupes;\n  };\n\n  hasPossibleDuplicates(i, placeId) {\n    return this.getPossibleDuplicates(i, placeId).length > 0;\n  };\n\n  requestIndex(i) {\n    return httpClient\n      .fetch('search?google_api_key=' + this.googleAPIKey + '&i=' + i + '&keyword=' + this.keyword, {\n        method: 'get'\n      })\n      .then(response => response.json())\n      .then(response => {\n        response.city_population = response.city_population.toLocaleString();\n        response.people_per_result = Math.round(response.people_per_result).toLocaleString();\n        this.searchResults.push(response);\n        this.searchResultsCount += response.result.results.length;\n      });\n  };\n\n  submit() {\n    let i = 0,\n        doRequest = () => {\n          this.requestIndex(i)\n            .then(() => {\n              i++;\n\n              if (i < SEARCH_RESULTS_CITY_LIMIT) {\n                doRequest();\n              } else {\n                this.isRequesting = false;\n              }\n            })\n            .catch(error => {\n              this.isRequesting = false;\n            });\n        };\n\n    if (!this.googleAPIKey) {\n      alert('Please enter a Google API Key to use for your search.');\n      return;\n    }\n\n    if (!this.keyword) {\n      alert('Please enter a keyword to to use for your search.');\n      return;\n    }\n\n    if (this.searchResults.length > 0 && !window.confirm(SEARCH_AGAIN_CONFIRM)) {\n      return;\n    }\n\n    if (this.isRequesting === false) {\n      this.isRequesting = true;\n      this.searchResults = [];\n      this.searchResultsCount = 0;\n      doRequest();\n    }\n  };\n\n  download() {\n    let dataStr,\n        dlAnchor;\n\n    if (window.confirm(SEARCH_RESULTS_DOWNLOAD_CONFIRM)) {\n      dataStr = 'data:text/json;charset=utf-8,' + encodeURIComponent(window.JSON.stringify(this.searchResults, null, 2)),\n      dlAnchor = window.document.getElementById('download-anchor');\n\n      dlAnchor.setAttribute('href', dataStr);\n      dlAnchor.setAttribute('download', 'places.json');\n      dlAnchor.click();\n    }\n  };\n};\n","export function configure(config) {\n  config.globalResources(['./elements/loading-indicator']);\n}\n","import * as nprogress from 'nprogress';\nimport {bindable, noView, decorators} from 'aurelia-framework';\n\nexport let LoadingIndicator = decorators(\n  // don't use an aurelia view (.html)\n  noView(\n    // same as require statement in html\n    ['nprogress/nprogress.css']\n  ),\n  // maps to loadingChanged()\n  bindable({name: 'loading', defaultValue: false})\n).on(class {\n  loadingChanged(newValue){\n    if (newValue) {\n      nprogress.start();\n    } else {\n      nprogress.done();\n    }\n  }\n});\n",null,null,null,null,null],"sourceRoot":"../src"}